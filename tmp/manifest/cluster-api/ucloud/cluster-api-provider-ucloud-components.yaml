apiVersion: v1
kind: Namespace
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-system

---
apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: manager-bootstrap-credentials
  namespace: capu-system
data:
  UCLOUD_ACCESS_PRIKEY: ZWNrYldSSWswX0tQUmRFS2pPeHZnd0ZtRnJ2ejRsMVd6YWk5dXM0Vmxvc1NwRFFrYzhCU3E5d2J1b0NHaW5EZg==
  UCLOUD_ACCESS_PUBKEY: WUY4eXJYc2xKN1lxOF94dWgzbDAzNmJ2NHVFZjNLemh0SHRJNFVKUQ==

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.2.6
  creationTimestamp: null
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
    cluster.x-k8s.io/v1alpha3: v1alpha3
  name: ucloudclusters.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: UCloudCluster
    listKind: UCloudClusterList
    plural: ucloudclusters
    singular: ucloudcluster
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Cluster to which this UCloudCluster belongs
      jsonPath: .metadata.labels.cluster\.x-k8s\.io/cluster-name
      name: Cluster
      type: string
    - description: Cluster infrastructure is ready for GCE instances
      jsonPath: .status.ready
      name: Ready
      type: string
    - description: UCLOUD network the cluster is using
      jsonPath: .spec.network.name
      name: Network
      type: string
    - description: API Endpoint
      jsonPath: .status.apiEndpoints[0]
      name: Endpoint
      priority: 1
      type: string
    name: v1alpha3
    schema:
      openAPIV3Schema:
        description: UCloudCluster is the Schema for the ucloudclusters API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: UCloudClusterSpec defines the desired state of UCloudCluster
            properties:
              bastion:
                description: Bastion
                properties:
                  sshPassword:
                    description: SSHPassword should be base64 encoded
                    type: string
                  zone:
                    description: Zone if not set, will choose a zone randomly in region
                    type: string
                type: object
              controlPlaneEndpoint:
                description: ControlPlaneEndpoint represents the endpoint used to
                  communicate with the control plane.
                properties:
                  host:
                    description: The hostname on which the API server is serving.
                    type: string
                  port:
                    description: The port on which the API server is serving.
                    format: int32
                    type: integer
                required:
                - host
                - port
                type: object
              network:
                description: NetworkSpec encapsulates all things related to UCLOUD
                  network.
                properties:
                  firewall:
                    description: FirewallSpec 安全组, 在创建ECS实例时必须指定安全组，每台ECS实例至少属于一个安全组
                    properties:
                      description:
                        description: 安全组描述信息。长度为2~256个英文或中文字符，不能以 http://和https://开头。
                          默认值：空。
                        type: string
                      firewallId:
                        description: 使用一个已经存在的安全组
                        type: string
                      firewallName:
                        description: 安全组名称。长度为2~128个英文或中文字符。必须以大小字母或中文开头，不能以 http://和https://开头。可以包含数字、半角冒号（:）、下划线（_）或者连字符（-）。默认值：空。
                        type: string
                      firewallType:
                        description: 安全组类型，分为普通安全组与企业安全组。取值范围：   normal：普通安全组。   enterprise：企业安全组
                        type: string
                      rules:
                        description: 安全组入方向规则
                        items:
                          description: FirewallRuleSpec 安全组入方向规则 详细文档见 [AuthorizeFirewall]
                          properties:
                            description:
                              description: 安全组规则的描述信息。长度为1~512个字符
                              type: string
                            destCidrIp:
                              description: 目的端IP地址范围。支持CIDR格式和IPv4格式的IP地址范围。   默认值：0.0.0.0/0。
                              type: string
                            ipProtocol:
                              description: 传输层协议。不区分大小写。取值范围：   icmp   gre   tcp   udp   all：支持所有协议
                              type: string
                            ipv6DestCidrIp:
                              description: 目的端IPv6 CIDR地址段。支持CIDR格式和IPv6格式的IP地址范围。   仅支持VPC类型的IP地址。   默认值：无。
                              type: string
                            ipv6SourceCidrIp:
                              description: 源端IPv6 CIDR地址段。支持CIDR格式和IPv6格式的IP地址范围。   仅支持VPC类型的IP地址。   默认值：无。
                              type: string
                            nicType:
                              description: 网卡类型。取值范围：   internet：公网网卡。   intranet：内网网卡。   当设置安全组之间互相访问时，即指定了DestGroupId且没有指定DestCidrIp时，参数NicType取值只能为intranet。   默认值：internet。
                              type: string
                            policy:
                              description: 访问权限。取值范围：   accept：接受访问。   drop：拒绝访问，不返回拒绝信息。   默认值：accept。
                              type: string
                            portRange:
                              description: 目的端安全组开放的传输层协议相关的端口范围。取值范围：   TCP/UDP协议：取值范围为1~65535。使用斜线（/）隔开起始端口和终止端口。正确示范：1/200；错误示范：200/1。   ICMP协议：-1/-1。   GRE协议：-1/-1。   all：-1/-1。
                              type: string
                            priority:
                              description: 安全组规则优先级。取值范围：1~100   默认值：1。
                              type: string
                            sourceCidrIp:
                              description: 源端IP地址范围。支持CIDR格式和IPv4格式的IP地址范围。   默认值：0.0.0.0/0。
                              type: string
                            sourceGroupId:
                              description: 设置访问权限的源端安全组ID。必须设置SourceGroupId或者SourceCidrIp参数。   如果指定了SourceGroupId没有指定参数SourceCidrIp，则参数NicType取值只能为
                                intranet。   如果同时指定了SourceGroupId和SourceCidrIp，则默认以SourceCidrIp为准。
                              type: string
                            sourceGroupOwnerAccount:
                              description: 跨账户设置安全组规则时，源端安全组所属的阿里云账户。   如果SourceGroupOwnerAccount及SourceGroupOwnerID均未设置，则认为是设置您其他安全组的访问权限。   如果已经设置参数SourceCidrIp，则参数SourceGroupOwnerAccount无效。
                              type: string
                            sourceGroupOwnerId:
                              description: 跨账户设置安全组规则时，源端安全组所属的阿里云账户ID。   如果SourceGroupOwnerId及SourceGroupOwnerAccount均未设置，则认为是设置您其他安全组的访问权限。   如果您已经设置参数SourceCidrIp，则参数SourceGroupOwnerId无效。
                              type: string
                            sourcePortRange:
                              description: 源端安全组开放的传输层协议相关的端口范围。取值范围：   TCP/UDP协议：取值范围为1~65535。使用斜线（/）隔开起始端口和终止端口。正确示范：1/200；错误示范：200/1。   ICMP协议：-1/-1。   GRE协议：-1/-1。   all：-1/-1。
                              type: string
                          type: object
                        type: array
                    type: object
                  nat:
                    description: NatSpec NAT网关相关配置, 在VPC环境下构建一个公网流量的出入口
                    properties:
                      eip:
                        description: EIPSpec 弹性公网IP 配置DNAT或SNAT功能前，需要为已创建的NAT网关绑定弹性公网IP
                        properties:
                          autoPay:
                            description: 是否自动付费，取值：   false：不开启自动付费，生成订单后需要到订单中心完成支付。   true：开启自动付费，自动支付订单。
                              当InstanceChargeType参数的值为PrePaid时，该参数必选；当InstanceChargeType参数的值为PostPaid时，该参数可不填。
                            type: string
                          bandwidth:
                            description: EIP的带宽峰值，单位为Mbps，默认值为5。
                            type: integer
                          eipId:
                            description: 使用一个已经存在的弹性公网IP
                            type: string
                          eipName:
                            type: string
                          instanceChargeType:
                            description: "EIP的计费方式，取值：   PrePaid：包年包月。   PostPaid（默认值）：按量计费。
                              \  当InstanceChargeType取值为PrePaid时，InternetChargeType必须取值PayByBandwidth；当InstanceChargeType取值为PostPaid时，InternetChargeType可取值PayByBandwidth或PayByTraffic。
                              \  包年包月和按量计费的详细信息，请参见包年包月和按量计费。"
                            type: string
                          internetChargeType:
                            description: "EIP的计量方式，取值：   PayByBandwidth（默认值）：按带宽计费。
                              \  PayByTraffic：按流量计费。 \n   当InstanceChargeType取值为PrePaid时，InternetChargeType必须取值PayByBandwidth。详细信息，请参见包年包月。
                              \  当InstanceChargeType取值为PostPaid时，InternetChargeType可取值PayByBandwidth或PayByTraffic。详细信息，请参见按使用流量和按固定带宽。"
                            type: string
                          isp:
                            description: 线路类型，默认值为BGP。   对于已开通单线带宽白名单的用户，ISP字段可以设置为ChinaTelecom、ChinaUnicom和ChinaMobile，用来开通中国电信、中国联通、中国移动的单线EIP。   如果是杭州金融云用户，该字段必填，取值：BGP_FinanceCloud。
                            type: string
                          period:
                            description: 购买时长。   当PricingCycle取值Month时，Period取值范围为1~9。   当PricingCycle取值Year时，Period取值范围为1~3。   如果InstanceChargeType参数的值为PrePaid时，该参数必选。
                            type: string
                          pricingCycle:
                            description: 包年包月的计费周期，取值：   Month（默认值）：按月付费。   Year：按年付费。
                              当InstanceChargeType参数的值为PrePaid时，该参数必选；当InstanceChargeType参数的值为PostPaid时，该参数可不填。
                            type: string
                        type: object
                      natGateway:
                        description: NAT网
                        properties:
                          autoPay:
                            description: 是否自动付费，取值：   false：不开启自动付费，生成订单后需要到订单中心完成支付。   true：开启自动付费，自动支付订单。
                              当InstanceChargeType参数的值为PrePaid时，该参数必选；当InstanceChargeType参数的值为PostPaid时，该参数可不填。
                            type: string
                          description:
                            description: NAT网关的描述。   描述在2~256个字符之间，不能以http://和https://开头。
                            type: string
                          duration:
                            description: 购买时长。   当PricingCycle取值Month时，Period取值范围为1~9。   当PricingCycle取值Year时，Period取值范围为1~3。   如果InstanceChargeType参数的值为PrePaid时，该参数必选。
                            type: string
                          instanceChargeType:
                            description: 计费方式，取值：   PrePaid：包年包月。   PostPaid（默认值）：按量计费。
                            type: string
                          name:
                            description: NAT网关的名称。   名称在2~128个字符之间，必须以英文字母或中文开头，不能以http://和https://开头，可包含数字、点号（.）、下划线（_）或短横线（-）。   如果没有指定该参数，默认使用网关ID。
                            type: string
                          natGatewayId:
                            description: 使用一个已经存在的NAT网关
                            type: string
                          pricingCycle:
                            description: 包年包月的计费周期，取值：   Month（默认值）：按月付费。   Year：按年付费。
                              当InstanceChargeType参数的值为PrePaid时，该参数必选；当InstanceChargeType参数的值为PostPaid时，该参数可不填。
                            type: string
                          spec:
                            description: NAT网关的规格。取值：   Small(默认值)：小型   Middle：中型   Large：大型   XLarge.1：超大型
                            type: string
                        type: object
                    type: object
                  subnet:
                    properties:
                      cidrBlock:
                        description: 子网的网段。子网网段要求如下：   子网网段的掩码长度范围为16-29位。   子网的网段必须从属于所在VPC的网段。   子网的网段不能与所在VPC中路由条目的目标网段相同，但可以是目标网段的子集。   如果子网的网段与所在VPC的网段相同时，VPC只能有一个子网。
                        type: string
                      description:
                        description: 子网的描述信息。   长度为 2-256个字符，必须以字母或中文开头，但不能以http://
                          或https://开头。
                        type: string
                      subnetId:
                        description: 使用一个已经存在的 Subnet
                        type: string
                      subnetName:
                        description: 子网的名称。   长度为 2-128个字符，必须以字母或中文开头，但不能以http://或https://开头。
                        type: string
                    type: object
                  ulb:
                    description: ULBSpec 负载均衡（Server Load Balancer）是对多台云服务器进行流量分发的负载均衡服务,
                      流量分发到apiserver
                    properties:
                      address:
                        description: 指定负载均衡实例的私网IP地址，该地址必须包含在子网的目标网段下。
                        type: string
                      addressIPVersion:
                        description: 负载均衡实例的IP版本，可以设置为ipv4或者ipv6
                        type: string
                      addressType:
                        description: 负载均衡实例的网络类型。取值：   OuterMode：创建公网负载均衡实例后，系统会分配一个公网IP地址，可以转发公网请求。   InnerMode：创建内网负载均衡实例后，系统会分配一个内网IP地址，仅可转发内网请求。
                        type: string
                      autoPay:
                        description: 是否是自动支付预付费公网实例的账单。  取值：true|false（默认）。  该参数仅适用于中国站。
                        type: string
                      bandwidth:
                        description: 监听的带宽峰值
                        type: integer
                      cloudType:
                        type: string
                      deleteProtection:
                        description: 是否开启实例删除保护
                        type: string
                      eip:
                        description: EIPSpec 弹性公网IP 配置DNAT或SNAT功能前，需要为已创建的NAT网关绑定弹性公网IP
                        properties:
                          autoPay:
                            description: 是否自动付费，取值：   false：不开启自动付费，生成订单后需要到订单中心完成支付。   true：开启自动付费，自动支付订单。
                              当InstanceChargeType参数的值为PrePaid时，该参数必选；当InstanceChargeType参数的值为PostPaid时，该参数可不填。
                            type: string
                          bandwidth:
                            description: EIP的带宽峰值，单位为Mbps，默认值为5。
                            type: integer
                          eipId:
                            description: 使用一个已经存在的弹性公网IP
                            type: string
                          eipName:
                            type: string
                          instanceChargeType:
                            description: "EIP的计费方式，取值：   PrePaid：包年包月。   PostPaid（默认值）：按量计费。
                              \  当InstanceChargeType取值为PrePaid时，InternetChargeType必须取值PayByBandwidth；当InstanceChargeType取值为PostPaid时，InternetChargeType可取值PayByBandwidth或PayByTraffic。
                              \  包年包月和按量计费的详细信息，请参见包年包月和按量计费。"
                            type: string
                          internetChargeType:
                            description: "EIP的计量方式，取值：   PayByBandwidth（默认值）：按带宽计费。
                              \  PayByTraffic：按流量计费。
                              \  当InstanceChargeType取值为PrePaid时，InternetChargeType必须取值PayByBandwidth。详细信息，请参见包年包月。
                              \  当InstanceChargeType取值为PostPaid时，InternetChargeType可取值PayByBandwidth或PayByTraffic。详细信息，请参见按使用流量和按固定带宽。"
                            type: string
                          isp:
                            description: 线路类型，默认值为BGP。   对于已开通单线带宽白名单的用户，ISP字段可以设置为ChinaTelecom、ChinaUnicom和ChinaMobile，用来开通中国电信、中国联通、中国移动的单线EIP。   如果是杭州金融云用户，该字段必填，取值：BGP_FinanceCloud。
                            type: string
                          period:
                            description: 购买时长。   当PricingCycle取值Month时，Period取值范围为1~9。   当PricingCycle取值Year时，Period取值范围为1~3。   如果InstanceChargeType参数的值为PrePaid时，该参数必选。
                            type: string
                          pricingCycle:
                            description: 包年包月的计费周期，取值：   Month（默认值）：按月付费。   Year：按年付费。
                              当InstanceChargeType参数的值为PrePaid时，该参数必选；当InstanceChargeType参数的值为PostPaid时，该参数可不填。
                            type: string
                        type: object
                      internetChargeType:
                        description: 公网类型实例的付费方式。取值：   paybybandwidth：按带宽计费。   paybytraffic：按流量计费（默认值）。
                        type: string
                      loadBalancerId:
                        description: 使用一个已经存在的负载均衡
                        type: string
                      loadBalancerName:
                        description: 负载均衡实例的名称。   长度为2-128个英文或中文字符，必须以大小字母或中文开头，可包含数字，点号（.），下划线（_）和短横线（-），字段长度不能超过80。   不指定该参数时，默认由系统分配一个实例名称。
                        type: string
                      loadBalancerSpec:
                        description: 负载均衡实例的规格。
                        type: string
                      masterZoneId:
                        description: 负载均衡实例的主可用区ID。
                        type: string
                      payType:
                        description: 实例的计费类型，取值：   PayOnDemand：按量付费。   PrePay：预付费。
                        type: string
                      pricingCycle:
                        description: 预付费公网实例的计费周期，取值：month|year 仅适用于中国站。
                        type: string
                      slaveZoneId:
                        description: 预付费公网实例的购买时长，取值：  如果PricingCycle为month，取值为1~9。  如果PricingCycle为year，取值为1~3。  该参数仅适用于中国站。
                          负载均衡实例的备可用区ID。
                        type: string
                      vserverId:
                        description: 使用一个已经存在的后端服务器组
                        type: string
                      vserverName:
                        description: 后端服务器组名
                        type: string
                    type: object
                  vpc:
                    description: VPCSpec 专有网络 使用云资源前, 必须先创建一个专有网络和子网
                    properties:
                      cidrBlock:
                        description: VPC的网段。您可以使用以下网段或其子集：   10.0.0.0/8。   172.16.0.0/12（默认值）。   192.168.0.0/16。
                        type: string
                      description:
                        description: VPC的描述信息。长度为2-256个字符，必须以字母或中文开头，但不能以http://或https://开头。
                        type: string
                      vpcId:
                        description: 使用一个已经存在的VPC
                        type: string
                      vpcName:
                        description: 专有网络名称。长度为2-128个字符，必须以字母或中文开头，可包含数字，点号（.），下划线（_）和短横线（-），但不能以http://或https://开头。
                        type: string
                    type: object
                type: object
              projectId:
                description: Project is the name of the project to deploy the cluster
                  to.
                type: string
              region:
                description: The UCLOUD Region the cluster lives in.
                type: string
              version:
                description: Version k8s version
                type: string
            required:
            - network
            - projectId
            - region
            - version
            type: object
          status:
            description: UCloudClusterStatus defines the observed state of UCloudCluster
            properties:
              bastion:
                description: Bastion
                properties:
                  instanceId:
                    type: string
                  instanceType:
                    type: string
                  privateIP:
                    type: string
                  publicIP:
                    type: string
                  zone:
                    type: string
                type: object
              clusterId:
                description: ClusterId generated by uk8s server
                type: string
              failureDomains:
                additionalProperties:
                  description: FailureDomainSpec is the Schema for Cluster API failure
                    domains. It allows controllers to understand how many failure
                    domains a cluster can optionally span across.
                  properties:
                    attributes:
                      additionalProperties:
                        type: string
                      description: Attributes is a free form map of attributes an
                        infrastructure provider might use or require.
                      type: object
                    controlPlane:
                      description: ControlPlane determines if this failure domain
                        is suitable for use by control plane machines.
                      type: boolean
                  type: object
                description: FailureDomains is a slice of FailureDomains.
                type: object
              group:
                properties:
                  groupId:
                    description: GroupId
                    type: string
                  groupName:
                    description: GroupName
                    type: string
                type: object
              network:
                properties:
                  firewall:
                    properties:
                      availableInstanceAmount:
                        type: integer
                      creationTime:
                        type: string
                      description:
                        type: string
                      ecsCount:
                        type: integer
                      firewallId:
                        type: string
                      firewallName:
                        type: string
                      firewallType:
                        type: string
                      resourceGroupId:
                        type: string
                      vpcId:
                        type: string
                    type: object
                  nat:
                    properties:
                      autoPay:
                        type: boolean
                      businessStatus:
                        type: string
                      creationTime:
                        type: string
                      deletionProtection:
                        type: boolean
                      description:
                        type: string
                      eip:
                        properties:
                          allocationTime:
                            type: string
                          bandwidth:
                            type: integer
                          chargeType:
                            type: string
                          deletionProtection:
                            type: boolean
                          descritpion:
                            type: string
                          eipAddr:
                            type: string
                          eipId:
                            type: string
                          eipName:
                            type: string
                          expiredTime:
                            type: string
                          hasReservationData:
                            type: string
                          hdMonitorStatus:
                            type: string
                          instanceRegionId:
                            type: string
                          instanceType:
                            type: string
                          internetChargeType:
                            type: string
                          isp:
                            type: string
                          mode:
                            type: string
                          resourceGroupId:
                            type: string
                          secondLimited:
                            type: boolean
                          status:
                            type: string
                        type: object
                      expiredTime:
                        type: string
                      firewall:
                        properties:
                          availableInstanceAmount:
                            type: integer
                          creationTime:
                            type: string
                          description:
                            type: string
                          ecsCount:
                            type: integer
                          firewallId:
                            type: string
                          firewallName:
                            type: string
                          firewallType:
                            type: string
                          resourceGroupId:
                            type: string
                          vpcId:
                            type: string
                        type: object
                      instanceChargeType:
                        type: string
                      name:
                        type: string
                      natGatewayId:
                        type: string
                      snatEntryId:
                        type: string
                      snatTableIds:
                        properties:
                          SnatTableId:
                            items:
                              type: string
                            type: array
                        required:
                        - SnatTableId
                        type: object
                      spec:
                        type: string
                      status:
                        type: string
                      vpcId:
                        type: string
                    type: object
                  subnet:
                    properties:
                      availableIpAddressCount:
                        format: int64
                        type: integer
                      cidrBlock:
                        type: string
                      creationTime:
                        type: string
                      description:
                        type: string
                      ipv6CidrBlock:
                        type: string
                      isDefault:
                        type: boolean
                      networkAclId:
                        type: string
                      resourceGroupId:
                        type: string
                      status:
                        type: string
                      subnetId:
                        type: string
                      subnetName:
                        type: string
                      vpcId:
                        type: string
                      zoneId:
                        type: string
                    type: object
                  ulb:
                    properties:
                      address:
                        type: string
                      addressIPVersion:
                        type: string
                      addressType:
                        type: string
                      createTime:
                        type: string
                      createTimeStamp:
                        format: int64
                        type: integer
                      eip:
                        properties:
                          allocationTime:
                            type: string
                          bandwidth:
                            type: integer
                          chargeType:
                            type: string
                          deletionProtection:
                            type: boolean
                          descritpion:
                            type: string
                          eipAddr:
                            type: string
                          eipId:
                            type: string
                          eipName:
                            type: string
                          expiredTime:
                            type: string
                          hasReservationData:
                            type: string
                          hdMonitorStatus:
                            type: string
                          instanceRegionId:
                            type: string
                          instanceType:
                            type: string
                          internetChargeType:
                            type: string
                          isp:
                            type: string
                          mode:
                            type: string
                          resourceGroupId:
                            type: string
                          secondLimited:
                            type: boolean
                          status:
                            type: string
                        type: object
                      internetChargeType:
                        type: string
                      loadBalancerId:
                        type: string
                      loadBalancerName:
                        type: string
                      loadBalancerStatus:
                        type: string
                      masterZoneId:
                        type: string
                      networkType:
                        type: string
                      payType:
                        type: string
                      regionId:
                        type: string
                      regionIdAlias:
                        type: string
                      resourceGroupId:
                        type: string
                      slaveZoneId:
                        type: string
                      vpcId:
                        type: string
                      vserverId:
                        type: string
                    type: object
                  vpc:
                    properties:
                      cenStatus:
                        type: string
                      cidrBlock:
                        type: string
                      creationTime:
                        type: string
                      description:
                        type: string
                      ipv6CidrBlock:
                        type: string
                      isDefault:
                        type: boolean
                      networkAclNum:
                        type: string
                      regionId:
                        type: string
                      resourceGroupId:
                        type: string
                      status:
                        type: string
                      vRouterId:
                        type: string
                      vpcId:
                        type: string
                      vpcName:
                        type: string
                    type: object
                type: object
              ready:
                type: boolean
            required:
            - ready
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.2.6
  creationTimestamp: null
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
    cluster.x-k8s.io/v1alpha3: v1alpha3
  name: ucloudmachines.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: UCloudMachine
    listKind: UCloudMachineList
    plural: ucloudmachines
    singular: ucloudmachine
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Cluster to which this UCloudMachine belongs
      jsonPath: .metadata.labels.cluster\.x-k8s\.io/cluster-name
      name: Cluster
      type: string
    - description: GCE instance state
      jsonPath: .status.instanceState
      name: State
      type: string
    - description: Machine ready status
      jsonPath: .status.ready
      name: Ready
      type: string
    - description: GCE instance ID
      jsonPath: .spec.providerID
      name: InstanceID
      type: string
    - description: Machine object which owns with this UCloudMachine
      jsonPath: .metadata.ownerReferences[?(@.kind=="Machine")].name
      name: Machine
      type: string
    name: v1alpha3
    schema:
      openAPIV3Schema:
        description: UCloudMachine is the Schema for the ucloudmachines API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: UCloudMachineSpec defines the desired state of UCloudMachine
            properties:
              additionalNetworkTags:
                description: AdditionalNetworkTags is a list of network tags that
                  should be applied to the instance. These tags are set in addition
                  to any network tags defined at the cluster level or in the actuator.
                items:
                  type: string
                type: array
              cpu:
                description: CPU core number
                type: integer
              dataDiskSize:
                description: DataDiskSize
                type: integer
              imageId:
                description: ImageId is the full reference to a valid image to be
                  used for this machine.
                type: string
              instanceType:
                description: 'InstanceType is the type of instance to create. Example:
                  n1.standard-2'
                type: string
              memory:
                description: Memory
                type: integer
              providerID:
                description: ProviderID is the unique identifier as specified by the
                  cloud provider.
                type: string
              publicIP:
                description: PublicIP specifies whether the instance should get a
                  public IP. Set this to true if you don't have a NAT instances or
                  Cloud Nat setup.
                type: boolean
              rootDiskSize:
                description: RootDiskSize
                type: integer
              sshPassword:
                description: SSHPassword should be base64 encoded
                type: string
            required:
            - instanceType
            type: object
          status:
            description: UCloudMachineStatus defines the observed state of UCloudMachine
            properties:
              addresses:
                description: Addresses contains the UCLOUD instance associated addresses.
                items:
                  description: MachineAddress contains information for the node's
                    address.
                  properties:
                    address:
                      description: The machine address.
                      type: string
                    type:
                      description: Machine address type, one of Hostname, ExternalIP
                        or InternalIP.
                      type: string
                  required:
                  - address
                  - type
                  type: object
                type: array
              clusterId:
                description: ClusterId
                type: string
              failureMessage:
                description: "FailureMessage will be set in the event that there is
                  a terminal problem reconciling the Machine and will contain a more
                  verbose string suitable for logging and human consumption. \n This
                  field should not be set for transitive errors that a controller
                  faces that are expected to be fixed automatically over time (like
                  service outages), but instead indicate that something is fundamentally
                  wrong with the Machine's spec or the configuration of the controller,
                  and that manual intervention is required. Examples of terminal errors
                  would be invalid combinations of settings in the spec, values that
                  are unsupported by the controller, or the responsible controller
                  itself being critically misconfigured. \n Any transient errors that
                  occur during the reconciliation of Machines can be added as events
                  to the Machine object and/or logged in the controller's output."
                type: string
              failureReason:
                description: "FailureReason will be set in the event that there is
                  a terminal problem reconciling the Machine and will contain a succinct
                  value suitable for machine interpretation. \n This field should
                  not be set for transitive errors that a controller faces that are
                  expected to be fixed automatically over time (like service outages),
                  but instead indicate that something is fundamentally wrong with
                  the Machine's spec or the configuration of the controller, and that
                  manual intervention is required. Examples of terminal errors would
                  be invalid combinations of settings in the spec, values that are
                  unsupported by the controller, or the responsible controller itself
                  being critically misconfigured. \n Any transient errors that occur
                  during the reconciliation of Machines can be added as events to
                  the Machine object and/or logged in the controller's output."
                type: string
              instanceId:
                description: InstanceId
                type: string
              instanceState:
                description: InstanceStatus is the status of the UCLOUD instance for
                  this machine.
                type: string
              ready:
                description: Ready is true when the provider resource is ready.
                type: boolean
              zone:
                description: Zone
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.2.6
  creationTimestamp: null
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
    cluster.x-k8s.io/v1alpha3: v1alpha3
  name: ucloudmachinetemplates.infrastructure.cluster.x-k8s.io
spec:
  group: infrastructure.cluster.x-k8s.io
  names:
    categories:
    - cluster-api
    kind: UCloudMachineTemplate
    listKind: UCloudMachineTemplateList
    plural: ucloudmachinetemplates
    singular: ucloudmachinetemplate
  scope: Namespaced
  versions:
  - name: v1alpha3
    schema:
      openAPIV3Schema:
        description: UCloudMachineTemplate is the Schema for the ucloudmachinetemplates
          API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: UCloudMachineTemplateSpec defines the desired state of UCloudMachineTemplate
            properties:
              template:
                description: UCloudMachineTemplateResource describes the data needed
                  to create am UCloudMachine from a template
                properties:
                  spec:
                    description: Spec is the specification of the desired behavior
                      of the machine.
                    properties:
                      additionalNetworkTags:
                        description: AdditionalNetworkTags is a list of network tags
                          that should be applied to the instance. These tags are set
                          in addition to any network tags defined at the cluster level
                          or in the actuator.
                        items:
                          type: string
                        type: array
                      cpu:
                        description: CPU core number
                        type: integer
                      dataDiskSize:
                        description: DataDiskSize
                        type: integer
                      imageId:
                        description: ImageId is the full reference to a valid image
                          to be used for this machine.
                        type: string
                      instanceType:
                        description: 'InstanceType is the type of instance to create.
                          Example: n1.standard-2'
                        type: string
                      memory:
                        description: Memory
                        type: integer
                      providerID:
                        description: ProviderID is the unique identifier as specified
                          by the cloud provider.
                        type: string
                      publicIP:
                        description: PublicIP specifies whether the instance should
                          get a public IP. Set this to true if you don't have a NAT
                          instances or Cloud Nat setup.
                        type: boolean
                      rootDiskSize:
                        description: RootDiskSize
                        type: integer
                      sshPassword:
                        description: SSHPassword should be base64 encoded
                        type: string
                    required:
                    - instanceType
                    type: object
                required:
                - spec
                type: object
            required:
            - template
            type: object
        type: object
    served: true
    storage: true
status:
  acceptedNames:
    kind: ""
    plural: ""
  conditions: []
  storedVersions: []

---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-leader-election-role
  namespace: capu-system
rules:
- apiGroups:
  - ""
  resources:
  - configmaps
  verbs:
  - get
  - list
  - watch
  - create
  - update
  - patch
  - delete
- apiGroups:
  - ""
  resources:
  - configmaps/status
  verbs:
  - get
  - update
  - patch

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  creationTimestamp: null
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-manager-role
rules:
- apiGroups:
  - ""
  resources:
  - events
  verbs:
  - create
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - ""
  resources:
  - secrets
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - cluster.x-k8s.io
  resources:
  - clusters
  - clusters/status
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - cluster.x-k8s.io
  resources:
  - machines
  - machines/status
  verbs:
  - get
  - list
  - watch
- apiGroups:
  - infrastructure.cluster.x-k8s.io
  resources:
  - ucloudclusters
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - infrastructure.cluster.x-k8s.io
  resources:
  - ucloudclusters/status
  verbs:
  - get
  - patch
  - update
- apiGroups:
  - infrastructure.cluster.x-k8s.io
  resources:
  - ucloudmachines
  verbs:
  - create
  - delete
  - get
  - list
  - patch
  - update
  - watch
- apiGroups:
  - infrastructure.cluster.x-k8s.io
  resources:
  - ucloudmachines/status
  verbs:
  - get
  - patch
  - update

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-proxy-role
rules:
- apiGroups:
  - authentication.k8s.io
  resources:
  - tokenreviews
  verbs:
  - create
- apiGroups:
  - authorization.k8s.io
  resources:
  - subjectaccessreviews
  verbs:
  - create

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-leader-election-rolebinding
  namespace: capu-system
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: capu-leader-election-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: capu-system

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-manager-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: capu-manager-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: capu-system

---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-proxy-rolebinding
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: capu-proxy-role
subjects:
- kind: ServiceAccount
  name: default
  namespace: capu-system

---
apiVersion: v1
kind: Service
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-webhook-service
  namespace: capi-webhook-system
spec:
  ports:
  - port: 443
    targetPort: webhook-server
  selector:
    cluster.x-k8s.io/provider: infrastructure-ucloud

---
apiVersion: v1
kind: Service
metadata:
  annotations:
    prometheus.io/port: "8443"
    prometheus.io/scheme: https
    prometheus.io/scrape: "true"
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
    control-plane: capu-controller-manager
  name: capu-controller-manager-metrics-service
  namespace: capu-system
spec:
  ports:
  - name: https
    port: 8443
    targetPort: https
  selector:
    cluster.x-k8s.io/provider: infrastructure-ucloud
    control-plane: capu-controller-manager

---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
    control-plane: capu-controller-manager
  name: capu-controller-manager
  namespace: capi-webhook-system
spec:
  replicas: 1
  selector:
    matchLabels:
      cluster.x-k8s.io/provider: infrastructure-ucloud
      control-plane: capu-controller-manager
  template:
    metadata:
      labels:
        cluster.x-k8s.io/provider: infrastructure-ucloud
        control-plane: capu-controller-manager
    spec:
      containers:
      - args:
        - --secure-listen-address=0.0.0.0:8443
        - --upstream=http://127.0.0.1:8080/
        - --logtostderr=true
        - --v=10
        image: gcr.io/kubebuilder/kube-rbac-proxy:v0.4.1
        name: kube-rbac-proxy
        ports:
        - containerPort: 8443
          name: https
      - args:
        - --metrics-addr=127.0.0.1:8080
        - --webhook-port=9443
        image: uhub.service.ucloud.cn/uk8s/cluster-api-ucloud-controller-amd64:dev
        imagePullPolicy: Always
        livenessProbe:
          httpGet:
            path: /healthz
            port: healthz
        name: manager
        ports:
        - containerPort: 9443
          name: webhook-server
          protocol: TCP
        - containerPort: 9440
          name: healthz
          protocol: TCP
        readinessProbe:
          httpGet:
            path: /readyz
            port: healthz
        volumeMounts:
        - mountPath: /tmp/k8s-webhook-server/serving-certs
          name: cert
          readOnly: true
      terminationGracePeriodSeconds: 10
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master
      volumes:
      - name: cert
        secret:
          defaultMode: 420
          secretName: capu-webhook-service-cert

---
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
    control-plane: capu-controller-manager
  name: capu-controller-manager
  namespace: capu-system
spec:
  replicas: 1
  selector:
    matchLabels:
      cluster.x-k8s.io/provider: infrastructure-ucloud
      control-plane: capu-controller-manager
  template:
    metadata:
      labels:
        cluster.x-k8s.io/provider: infrastructure-ucloud
        control-plane: capu-controller-manager
    spec:
      containers:
      - args:
        - --secure-listen-address=0.0.0.0:8443
        - --upstream=http://127.0.0.1:8080/
        - --logtostderr=true
        - --v=10
        image: gcr.io/kubebuilder/kube-rbac-proxy:v0.4.1
        name: kube-rbac-proxy
        ports:
        - containerPort: 8443
          name: https
      - args:
        - --metrics-addr=127.0.0.1:8080
        - --enable-leader-election
        envFrom:
        - secretRef:
            name: manager-bootstrap-credentials
        image: uhub.service.ucloud.cn/uk8s/cluster-api-ucloud-controller-amd64:dev
        imagePullPolicy: Always
        livenessProbe:
          httpGet:
            path: /healthz
            port: healthz
        name: manager
        ports:
        - containerPort: 9440
          name: healthz
          protocol: TCP
        readinessProbe:
          httpGet:
            path: /readyz
            port: healthz
      terminationGracePeriodSeconds: 10
      tolerations:
      - effect: NoSchedule
        key: node-role.kubernetes.io/master

---
apiVersion: cert-manager.io/v1alpha2
kind: Certificate
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-serving-cert
  namespace: capi-webhook-system
spec:
  dnsNames:
  - capu-webhook-service.capi-webhook-system.svc
  - capu-webhook-service.capi-webhook-system.svc.cluster.local
  issuerRef:
    kind: Issuer
    name: capu-selfsigned-issuer
  secretName: capu-webhook-service-cert

---
apiVersion: cert-manager.io/v1alpha2
kind: Issuer
metadata:
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-selfsigned-issuer
  namespace: capi-webhook-system
spec:
  selfSigned: {}

---
apiVersion: admissionregistration.k8s.io/v1beta1
kind: ValidatingWebhookConfiguration
metadata:
  annotations:
    cert-manager.io/inject-ca-from: capi-webhook-system/capu-serving-cert
  creationTimestamp: null
  labels:
    cluster.x-k8s.io/provider: infrastructure-ucloud
  name: capu-validating-webhook-configuration
webhooks:
- clientConfig:
    caBundle: Cg==
    service:
      name: capu-webhook-service
      namespace: capi-webhook-system
      path: /validate-infrastructure-cluster-x-k8s-io-v1alpha3-ucloudmachine
  failurePolicy: Fail
  matchPolicy: Equivalent
  name: validation.ucloudmachine.infrastructure.cluster.x-k8s.io
  rules:
  - apiGroups:
    - infrastructure.cluster.x-k8s.io
    apiVersions:
    - v1alpha3
    operations:
    - CREATE
    - UPDATE
    resources:
    - ucloudmachines
- clientConfig:
    caBundle: Cg==
    service:
      name: capu-webhook-service
      namespace: capi-webhook-system
      path: /validate-infrastructure-cluster-x-k8s-io-v1alpha3-ucloudmachinetemplate
  failurePolicy: Fail
  matchPolicy: Equivalent
  name: validation.ucloudmachinetemplate.infrastructure.x-k8s.io
  rules:
  - apiGroups:
    - infrastructure.cluster.x-k8s.io
    apiVersions:
    - v1alpha3
    operations:
    - CREATE
    - UPDATE
    resources:
    - ucloudmachinetemplates
